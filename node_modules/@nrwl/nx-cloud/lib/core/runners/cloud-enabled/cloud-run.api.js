const a3_0xb113=['Invalid\x20Nx\x20Cloud\x20response:\x20','defaults','throw','post','../../../utilities/axios','stringify','next','application/octet-stream','__awaiter','slice','startRun','from','success','/nx-cloud/runs/start','/nx-cloud/runs/end','terminalOutput','devDependencies','axiosMultipleTries','message','createApiAxiosInstance','CloudRunApi','readFileSync','done','headers','apply','Invalid\x20end\x20run\x20response:\x20','unknown','promisify','mapRespToPerfEntry','api','urls','runContext','axiosException','RUNNER_FAILURE_PERF_ENTRY','package.json','...','Nx\x20Cloud:\x20Unknown\x20Error\x20Occurred','__esModule','response','../../../utilities/environment','defineProperty','RunEnd.\x20Completed\x20tasks','Run\x20completion\x20responded\x20with\x20`undefined`.','Stack\x20Trace:','RunStart','machineInfo','getBranch','error','apiAxiosInstance','nxCloudVersion','extractErrorMessage','data','gzip','../../../utilities/nx-imports','map','runUrl','apiError','value','string','VERBOSE_LOGGING','status','recordMetric','createMetricRecorder','endRun','util','messages','assign'];(function(_0x3baf84,_0xb11336){const _0x2876bf=function(_0x45cd6b){while(--_0x45cd6b){_0x3baf84['push'](_0x3baf84['shift']());}};_0x2876bf(++_0xb11336);}(a3_0xb113,0x15e));const a3_0x2876=function(_0x3baf84,_0xb11336){_0x3baf84=_0x3baf84-0x0;let _0x2876bf=a3_0xb113[_0x3baf84];return _0x2876bf;};'use strict';var __awaiter=this&&this[a3_0x2876('0x3c')]||function(_0x56e9df,_0x13e104,_0x98cba1,_0x4014b7){function _0x23bfa8(_0x23a1a4){return _0x23a1a4 instanceof _0x98cba1?_0x23a1a4:new _0x98cba1(function(_0x3c49c1){_0x3c49c1(_0x23a1a4);});}return new(_0x98cba1||(_0x98cba1=Promise))(function(_0x5a8b64,_0xec760e){function _0x2ad010(_0x282f14){try{_0x5e7613(_0x4014b7[a3_0x2876('0x3a')](_0x282f14));}catch(_0x150f93){_0xec760e(_0x150f93);}}function _0x395029(_0x3525c8){try{_0x5e7613(_0x4014b7[a3_0x2876('0x36')](_0x3525c8));}catch(_0x5a8609){_0xec760e(_0x5a8609);}}function _0x5e7613(_0x250393){_0x250393[a3_0x2876('0x7')]?_0x5a8b64(_0x250393['value']):_0x23bfa8(_0x250393[a3_0x2876('0x2a')])['then'](_0x2ad010,_0x395029);}_0x5e7613((_0x4014b7=_0x4014b7[a3_0x2876('0x9')](_0x56e9df,_0x13e104||[]))[a3_0x2876('0x3a')]());});};Object[a3_0x2876('0x19')](exports,a3_0x2876('0x16'),{'value':!![]});exports['CloudRunApi']=void 0x0;const axios_1=require(a3_0x2876('0x38'));const environment_1=require(a3_0x2876('0x18'));const fs_1=require('fs');const zlib_1=require('zlib');const util_1=require(a3_0x2876('0x31'));const metric_logger_1=require('../../../utilities/metric-logger');const {output}=require(a3_0x2876('0x26'));class CloudRunApi{constructor(_0x52a1b7,_0x1c95f2,_0x5c4ed4,_0x20ae62){this[a3_0x2876('0x32')]=_0x52a1b7;this[a3_0x2876('0x10')]=_0x1c95f2;this[a3_0x2876('0x1e')]=_0x20ae62;this[a3_0x2876('0x21')]=(0x0,axios_1[a3_0x2876('0x4')])(_0x5c4ed4);}[a3_0x2876('0x3e')](_0x33de87,_0x5455d2){var _0x33c726;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x8059d9=(0x0,metric_logger_1[a3_0x2876('0x2f')])(a3_0x2876('0x3e'));try{const _0x306c93={'meta':{'nxCloudVersion':this['nxCloudVersion']()},'branch':(0x0,environment_1[a3_0x2876('0x1f')])(),'runGroup':(0x0,environment_1['getRunGroup'])(),'distributedExecutionId':_0x33de87,'hashes':_0x5455d2};if(environment_1[a3_0x2876('0x2c')]){output['note']({'title':a3_0x2876('0x1d'),'bodyLines':['\x0a'+JSON[a3_0x2876('0x39')](_0x306c93,null,0x2)]});}const _0x1e1633=yield(0x0,axios_1[a3_0x2876('0x2')])(()=>this[a3_0x2876('0x21')][a3_0x2876('0x37')](a3_0x2876('0x41'),_0x306c93));_0x8059d9[a3_0x2876('0x2e')]((0x0,metric_logger_1[a3_0x2876('0xd')])(_0x1e1633));if(_0x1e1633[a3_0x2876('0x24')]&&_0x1e1633[a3_0x2876('0x24')]['message']){this[a3_0x2876('0x32')][a3_0x2876('0x3')]=_0x1e1633[a3_0x2876('0x24')]['message'];}if(!_0x1e1633[a3_0x2876('0x24')]||!_0x1e1633['data'][a3_0x2876('0xf')]){this[a3_0x2876('0x32')][a3_0x2876('0x29')]=a3_0x2876('0x34')+JSON[a3_0x2876('0x39')](_0x1e1633[a3_0x2876('0x24')]);return{};}return _0x1e1633[a3_0x2876('0x24')][a3_0x2876('0xf')];}catch(_0x124fb2){_0x8059d9[a3_0x2876('0x2e')](((_0x33c726=_0x124fb2===null||_0x124fb2===void 0x0?void 0x0:_0x124fb2[a3_0x2876('0x11')])===null||_0x33c726===void 0x0?void 0x0:_0x33c726[a3_0x2876('0x17')])?(0x0,metric_logger_1[a3_0x2876('0xd')])(_0x124fb2[a3_0x2876('0x11')]['response']):metric_logger_1[a3_0x2876('0x12')]);this[a3_0x2876('0x32')][a3_0x2876('0x29')]=this[a3_0x2876('0x32')]['extractErrorMessage'](_0x124fb2,a3_0x2876('0xe'));return{};}});}[a3_0x2876('0x30')](_0x2fd223,_0x4ea7db){var _0x25b97e,_0x15863a;return __awaiter(this,void 0x0,void 0x0,function*(){if(this[a3_0x2876('0x32')][a3_0x2876('0x29')])return![];const _0x2d8e8b={'meta':{'nxCloudVersion':this[a3_0x2876('0x22')]()},'tasks':_0x4ea7db,'run':_0x2fd223,'machineInfo':this[a3_0x2876('0x1e')]};const _0x315244=Buffer[a3_0x2876('0x3f')](JSON[a3_0x2876('0x39')](_0x2d8e8b));const _0x147342=yield(0x0,util_1[a3_0x2876('0xc')])(zlib_1[a3_0x2876('0x25')])(_0x315244);const _0x262a5e=(0x0,metric_logger_1[a3_0x2876('0x2f')])(a3_0x2876('0x30'));try{if(environment_1[a3_0x2876('0x2c')]){const _0x1a78f0=_0x4ea7db[a3_0x2876('0x27')](_0x5f2f50=>{return Object[a3_0x2876('0x33')](Object['assign']({},_0x5f2f50),{'terminalOutput':_0x5f2f50['terminalOutput']?_0x5f2f50[a3_0x2876('0x0')][a3_0x2876('0x3d')](0x0,0x14)+a3_0x2876('0x14'):undefined});});output['note']({'title':a3_0x2876('0x1a'),'bodyLines':['\x0a'+JSON[a3_0x2876('0x39')](_0x1a78f0,null,0x2)]});}const _0x1edb6a=yield(0x0,axios_1['axiosMultipleTries'])(()=>this[a3_0x2876('0x21')][a3_0x2876('0x37')](a3_0x2876('0x42'),_0x147342,{'headers':Object[a3_0x2876('0x33')](Object['assign']({},this[a3_0x2876('0x21')][a3_0x2876('0x35')][a3_0x2876('0x8')]),{'Content-Encoding':'gzip','Content-Type':a3_0x2876('0x3b')})}));if(_0x1edb6a){_0x262a5e[a3_0x2876('0x2e')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x1edb6a));if(_0x1edb6a['data']&&_0x1edb6a['data'][a3_0x2876('0x28')]&&_0x1edb6a[a3_0x2876('0x24')][a3_0x2876('0x2d')]===a3_0x2876('0x40')){this[a3_0x2876('0x10')][a3_0x2876('0x28')]=_0x1edb6a[a3_0x2876('0x24')][a3_0x2876('0x28')];return!![];}if(_0x1edb6a[a3_0x2876('0x24')]&&_0x1edb6a['data'][a3_0x2876('0x2d')]){this[a3_0x2876('0x32')][a3_0x2876('0x29')]=a3_0x2876('0xa')+JSON[a3_0x2876('0x39')](_0x1edb6a[a3_0x2876('0x24')][a3_0x2876('0x3')]);}else if(_0x1edb6a[a3_0x2876('0x24')]&&typeof _0x1edb6a[a3_0x2876('0x24')]===a3_0x2876('0x2b')){if(_0x1edb6a[a3_0x2876('0x24')]!==a3_0x2876('0x40')){this['messages'][a3_0x2876('0x29')]='Invalid\x20end\x20run\x20response:\x20'+JSON['stringify'](_0x1edb6a[a3_0x2876('0x24')]);}}else{this[a3_0x2876('0x32')][a3_0x2876('0x29')]='Invalid\x20end\x20run\x20response:\x20'+JSON['stringify'](_0x1edb6a[a3_0x2876('0x24')]);}if(environment_1[a3_0x2876('0x2c')]){output['note']({'title':'Invalid\x20end\x20run\x20response','bodyLines':[JSON[a3_0x2876('0x39')](_0x1edb6a[a3_0x2876('0x24')],null,0x2)]});}}else{output[a3_0x2876('0x20')]({'title':a3_0x2876('0x15'),'bodyLines':[a3_0x2876('0x1b'),'Run\x20Details:',JSON[a3_0x2876('0x39')](_0x2fd223,null,0x2),a3_0x2876('0x1c'),JSON[a3_0x2876('0x39')](new Error()['stack'],null,0x2)]});}return![];}catch(_0xdb202a){_0x262a5e['recordMetric'](((_0x25b97e=_0xdb202a===null||_0xdb202a===void 0x0?void 0x0:_0xdb202a[a3_0x2876('0x11')])===null||_0x25b97e===void 0x0?void 0x0:_0x25b97e['response'])?(0x0,metric_logger_1[a3_0x2876('0xd')])(_0xdb202a['axiosException']['response']):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);const _0x4b6856=(_0x15863a=_0xdb202a[a3_0x2876('0x11')])!==null&&_0x15863a!==void 0x0?_0x15863a:_0xdb202a;this[a3_0x2876('0x32')][a3_0x2876('0x29')]=this[a3_0x2876('0x32')][a3_0x2876('0x23')](_0x4b6856,a3_0x2876('0xe'));return![];}});}[a3_0x2876('0x22')](){try{const _0xdabd82=JSON['parse']((0x0,fs_1[a3_0x2876('0x6')])(a3_0x2876('0x13'))['toString']());return _0xdabd82[a3_0x2876('0x1')]['@nrwl/nx-cloud'];}catch(_0x13159c){return a3_0x2876('0xb');}}}exports[a3_0x2876('0x5')]=CloudRunApi;