const a1_0x5309=['../../file-storage/file-storage','DISTRIBUTED_TASK_EXECUTION_INTERNAL_ERROR_STATUS_CODE','path','anyErrors','getRunGroup','./cloud-run.api','extractGitSha','../../../utilities/metric-logger','join','printCacheHitsMessage','getMachineInfo','forEach','hash','MessageReporter','AGENT_RUNNING_IN_DISTRIBUTED_EXECUTION','toISOString','parseCommand','NX_CLOUD_DISTRIBUTED_EXECUTION_ID','Executed\x20tasks\x20with\x20hashes:\x20','./cloud-enabled-life-cycle','requests','FileStorage','cacheableOperations','all','EndOfRunMessage','__awaiter','note','./cloud-remote-cache','scan','cloudEnabledTasksRunner','exit','error','CloudRunApi','CloudEnabledLifeCycle','submitRunMetrics','../../terminal-output/output-obfuscator','cacheDirectory','defineProperty','maskedProperties','filter','map','complete','apply','next','skipNxCache','endRun','encryptionKey','Agent\x20wasn\x27t\x20able\x20to\x20record\x20its\x20run','__esModule','rxjs/internal/Subject','getBranch','stringify','VERBOSE_LOGGING','Subject','../../terminal-output/end-of-run-message','printMessages','tasks-hashes-','lifeCycle','then','assign','waitForStoreRequestsToComplete','CloudRemoteCache','OutputObfuscator','taskId','value','../../file-storage/e2e-encryption','E2EEncryption','../../../utilities/environment','../../terminal-output/message-reporter','done'];(function(_0x10711b,_0x53098e){const _0x7ae59e=function(_0x29a4bf){while(--_0x29a4bf){_0x10711b['push'](_0x10711b['shift']());}};_0x7ae59e(++_0x53098e);}(a1_0x5309,0xa9));const a1_0x7ae5=function(_0x10711b,_0x53098e){_0x10711b=_0x10711b-0x0;let _0x7ae59e=a1_0x5309[_0x10711b];return _0x7ae59e;};'use strict';var __awaiter=this&&this[a1_0x7ae5('0x42')]||function(_0x269467,_0x1ee7ab,_0x1a710f,_0x5c9121){function _0x14c897(_0x49a8c9){return _0x49a8c9 instanceof _0x1a710f?_0x49a8c9:new _0x1a710f(function(_0x3def0f){_0x3def0f(_0x49a8c9);});}return new(_0x1a710f||(_0x1a710f=Promise))(function(_0x927a55,_0x5f4ab7){function _0x20f2e0(_0x32ec46){try{_0x2c9fb8(_0x5c9121[a1_0x7ae5('0xe')](_0x32ec46));}catch(_0x401bbd){_0x5f4ab7(_0x401bbd);}}function _0x47a7bd(_0x4a6870){try{_0x2c9fb8(_0x5c9121['throw'](_0x4a6870));}catch(_0x4128c0){_0x5f4ab7(_0x4128c0);}}function _0x2c9fb8(_0x4b8b79){_0x4b8b79[a1_0x7ae5('0x28')]?_0x927a55(_0x4b8b79[a1_0x7ae5('0x23')]):_0x14c897(_0x4b8b79['value'])[a1_0x7ae5('0x1d')](_0x20f2e0,_0x47a7bd);}_0x2c9fb8((_0x5c9121=_0x5c9121[a1_0x7ae5('0xd')](_0x269467,_0x1ee7ab||[]))[a1_0x7ae5('0xe')]());});};Object[a1_0x7ae5('0x8')](exports,a1_0x7ae5('0x13'),{'value':!![]});exports[a1_0x7ae5('0x0')]=void 0x0;const Subject_1=require(a1_0x7ae5('0x14'));const message_reporter_1=require(a1_0x7ae5('0x27'));const end_of_run_message_1=require(a1_0x7ae5('0x19'));const output_obfuscator_1=require(a1_0x7ae5('0x6'));const cloud_enabled_life_cycle_1=require(a1_0x7ae5('0x3c'));const file_storage_1=require(a1_0x7ae5('0x29'));const e2e_encryption_1=require(a1_0x7ae5('0x24'));const environment_1=require(a1_0x7ae5('0x26'));const cloud_remote_cache_1=require(a1_0x7ae5('0x44'));const cloud_run_api_1=require(a1_0x7ae5('0x2e'));const fs_1=require('fs');const path=require(a1_0x7ae5('0x2b'));const metric_logger_1=require(a1_0x7ae5('0x30'));const {tasksRunnerV2,output}=require('../../../utilities/nx-imports');function createApi(_0x11dde4,_0x17e6ea,_0x578468){const _0x37ba5f=(0x0,environment_1[a1_0x7ae5('0x33')])(_0x17e6ea);return new cloud_run_api_1[(a1_0x7ae5('0x3'))](_0x11dde4,_0x578468,_0x17e6ea,_0x37ba5f);}function storeTaskHashes(_0x51ad15,_0x427c51,_0xe64b67){const _0x3c5110=JSON[a1_0x7ae5('0x16')](_0x51ad15[a1_0x7ae5('0xb')](_0x3c34ba=>({'taskId':_0x3c34ba[a1_0x7ae5('0x22')],'hash':_0x3c34ba[a1_0x7ae5('0x35')]})));if(environment_1[a1_0x7ae5('0x17')]){output[a1_0x7ae5('0x43')]({'title':a1_0x7ae5('0x3b')+_0x3c5110});}(0x0,fs_1['writeFileSync'])(path[a1_0x7ae5('0x31')](_0x427c51,a1_0x7ae5('0x1b')+_0xe64b67),_0x3c5110);}function onComplete(_0x94a757,_0x1e8ffa,_0x2b1a68,_0x17c81e,_0x206550,_0x1c4f5e,_0x14ec2,_0x33fbc4,_0xa9da88,_0x5bc2ab,_0x1e4335){return __awaiter(this,void 0x0,void 0x0,function*(){const _0xcac456=new Date()[a1_0x7ae5('0x38')]();if(environment_1[a1_0x7ae5('0x37')]){storeTaskHashes(_0xa9da88,_0x1e8ffa[a1_0x7ae5('0x7')]||'./node_modules/.cache/nx',environment_1[a1_0x7ae5('0x3a')]);}const _0x53c1a5=(0x0,environment_1[a1_0x7ae5('0x15')])();const _0x5a757f=yield Promise[a1_0x7ae5('0x40')]([_0x2b1a68[a1_0x7ae5('0x1f')](),_0x17c81e[a1_0x7ae5('0x10')]({'command':_0x206550['obfuscate']((0x0,environment_1[a1_0x7ae5('0x39')])()),'startTime':_0x1c4f5e,'endTime':_0xcac456,'distributedExecutionId':environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_ID'],'branch':_0x53c1a5,'scan':!![],'runGroup':(0x0,environment_1[a1_0x7ae5('0x2d')])(),'sha':_0x53c1a5?(0x0,environment_1[a1_0x7ae5('0x2f')])():undefined,'inner':_0x1e4335},_0xa9da88)]);if(_0x5bc2ab){setTimeout(()=>{_0x14ec2[a1_0x7ae5('0x1a')]();if(!_0x14ec2[a1_0x7ae5('0x2c')]&&!_0x1e4335){_0x33fbc4[a1_0x7ae5('0x32')]();}},0x0);}else{_0x14ec2[a1_0x7ae5('0x1a')]();if(!_0x14ec2[a1_0x7ae5('0x2c')]&&!_0x1e4335){_0x33fbc4[a1_0x7ae5('0x32')]();}}if(environment_1[a1_0x7ae5('0x37')]){if(!_0x5a757f[0x0]){output[a1_0x7ae5('0x2')]({'title':'Agent\x20wasn\x27t\x20able\x20to\x20store\x20artifacts'});_0x14ec2['printMessages']();process[a1_0x7ae5('0x1')](environment_1[a1_0x7ae5('0x2a')]);}if(!_0x5a757f[0x1]){output['error']({'title':a1_0x7ae5('0x12')});_0x14ec2[a1_0x7ae5('0x1a')]();process[a1_0x7ae5('0x1')](environment_1[a1_0x7ae5('0x2a')]);}}yield(0x0,metric_logger_1[a1_0x7ae5('0x5')])(_0x1e8ffa);});}function createLifeCycle(_0x32934d,_0xeb3467,_0x25161a,_0x60c42){const _0x5b9050=new cloud_enabled_life_cycle_1[(a1_0x7ae5('0x4'))](_0x32934d,_0xeb3467[a1_0x7ae5('0x7')],!!_0xeb3467[a1_0x7ae5('0xf')],_0xeb3467[a1_0x7ae5('0x45')]===undefined?!![]:_0xeb3467['scan'],_0xeb3467[a1_0x7ae5('0x3f')]||[],_0x25161a,_0x60c42);try{const {CompositeLifeCycle}=require('../../../utilities/nx-imports');if(!CompositeLifeCycle)return _0x5b9050;return new CompositeLifeCycle([_0xeb3467['lifeCycle'],_0x5b9050]);}catch(_0x83ae4e){return _0x5b9050;}}function cloudEnabledTasksRunner(_0x5daed6,_0x488450,_0x48f5c9,_0x4bce08=![]){const _0x1c57dd={'statuses':{},'scheduledTasks':[],'requests':{},'allTasks':_0x5daed6};const _0x206223=_0x488450[a1_0x7ae5('0x1c')]===undefined;const _0x2b4243=[];const _0x44ec77=new message_reporter_1[(a1_0x7ae5('0x36'))](_0x488450);const _0x19287e=createApi(_0x44ec77,_0x488450,_0x1c57dd);const _0x550c4d=new end_of_run_message_1[(a1_0x7ae5('0x41'))](_0x1c57dd,_0x2b4243);const _0x535c27=new output_obfuscator_1[(a1_0x7ae5('0x21'))](_0x488450[a1_0x7ae5('0x9')]);const _0x53f608=_0x5daed6[a1_0x7ae5('0xb')](_0x4886ff=>_0x4886ff['hash'])[a1_0x7ae5('0xa')](_0x2cf4c8=>!!_0x2cf4c8);const _0x3e1224=_0x19287e['startRun'](environment_1[a1_0x7ae5('0x3a')],_0x53f608);_0x53f608[a1_0x7ae5('0x34')](_0x360d24=>{_0x1c57dd[a1_0x7ae5('0x3d')][_0x360d24]=_0x3e1224;});const _0x3566aa=new Date()['toISOString']();const _0x182266=createLifeCycle(_0x1c57dd,_0x488450,_0x535c27,_0x2b4243);const _0x24a3b2=new e2e_encryption_1[(a1_0x7ae5('0x25'))](environment_1['ENCRYPTION_KEY']||_0x488450[a1_0x7ae5('0x11')]);const _0x34b4d1=new file_storage_1[(a1_0x7ae5('0x3e'))](_0x24a3b2);const _0x4cc90c=new cloud_remote_cache_1[(a1_0x7ae5('0x20'))](_0x44ec77,_0x19287e,_0x1c57dd,_0x34b4d1);delete process['env'][a1_0x7ae5('0x3a')];const _0x99b6ec=tasksRunnerV2(_0x5daed6,Object[a1_0x7ae5('0x1e')](Object['assign']({},_0x488450),{'remoteCache':_0x4cc90c,'lifeCycle':_0x182266}),_0x48f5c9);if(_0x99b6ec['subscribe']){const _0x289888=new Subject_1[(a1_0x7ae5('0x18'))]();_0x99b6ec['subscribe']({'next':_0x2779d8=>_0x289888[a1_0x7ae5('0xe')](_0x2779d8),'error':_0x339db3=>_0x289888[a1_0x7ae5('0x2')](_0x339db3),'complete':()=>__awaiter(this,void 0x0,void 0x0,function*(){yield onComplete(_0x182266,_0x488450,_0x4cc90c,_0x19287e,_0x535c27,_0x3566aa,_0x44ec77,_0x550c4d,_0x2b4243,_0x206223,_0x4bce08);_0x289888[a1_0x7ae5('0xc')]();})});return _0x289888;}else{return _0x99b6ec[a1_0x7ae5('0x1d')](_0x2a6481=>__awaiter(this,void 0x0,void 0x0,function*(){yield onComplete(_0x182266,_0x488450,_0x4cc90c,_0x19287e,_0x535c27,_0x3566aa,_0x44ec77,_0x550c4d,_0x2b4243,_0x206223,_0x4bce08);return _0x2a6481;}))['catch'](_0x41202e=>__awaiter(this,void 0x0,void 0x0,function*(){yield onComplete(_0x182266,_0x488450,_0x4cc90c,_0x19287e,_0x535c27,_0x3566aa,_0x44ec77,_0x550c4d,_0x2b4243,_0x206223,_0x4bce08);throw _0x41202e;}));}}exports[a1_0x7ae5('0x0')]=cloudEnabledTasksRunner;